<section id="hdls-membership-container">
  <div class="search-section">
    <div class="add-product">
      <form (submit)="setSearchValue($event)" class="hdls-search-field">
        <input
          type="text"
          (change)="getSearchDetails($event)"
          matInput
          placeholder="Search"
        />
        <span>
          <a href="#" (click)="setSearchValue($event)">
            <img src="../../../assets/images/search.png" alt="Search" />
          </a>
        </span>
      </form>
    </div>
    <div class="hdls-filter">
      <form
        [formGroup]="hotelGroup"
        (ngSubmit)="getHotelBookings()"
        class="hdls-hotel-filter"
      >
        <mat-form-field class="hdls-form-field" appearance="fill">
          <mat-label>Membership Package</mat-label>
          <mat-select class="hdls-form-select" formControlName="hotelid">
            <mat-option
              *ngFor="let hotels of hotelDetails"
              [key]="hotels.hotel_id"
              [value]="hotels.hotel_id"
              >{{ hotels.hotel_name }}</mat-option
            >
          </mat-select>
        </mat-form-field>
        <mat-form-field class="hdls-hotel-filter-date">
          <mat-label>Choose From Date</mat-label>
          <div class="hdls-date-picker">
            <input
              matInput
              [matDatepicker]="picker"
              formControlName="from_date"
            />
            <mat-datepicker-toggle
              matIconSuffix
              [for]="picker"
            ></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
          </div>
        </mat-form-field>
        <mat-form-field class="hdls-hotel-filter-date">
          <mat-label>Choose To Date</mat-label>
          <div class="hdls-date-picker">
            <input
              matInput
              [matDatepicker]="topicker"
              formControlName="to_date"
            />
            <mat-datepicker-toggle
              matIconSuffix
              [for]="topicker"
            ></mat-datepicker-toggle>
            <mat-datepicker #topicker></mat-datepicker>
          </div>
        </mat-form-field>
        <button
          type="button"
          (click)="getHotelBookings()"
          class="hdls-search-btn"
        >
          Search
        </button>
      </form>
    </div>
    <div class="download-section">
        
      <div class="download-button">
        <button mat-raised-button
          ><img src="../../../assets/images/download.png" alt="download"
        /> View / Download</button>
      </div>
    </div>
  </div>
  <div id="hdls-membership-list">
    <div class="hdls-product-list-section hdls-membership-purchase-container">
      <!-- <app-search-field></app-search-field> -->
      <table
        mat-table
        class="hdls-product-table"
        [dataSource]="dataSource"
        matTableExporter
      >
        <ng-container matColumnDef="transaction_id">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            Transaction ID
          </th>
          <td mat-cell *matCellDef="let element">
            <p *ngIf="!element.isLoading">
              <a
                [routerLink]="[
                  '/report/order-booking-detail',
                  element.bookingid
                ]"
                >{{ element.bookingid }}</a
              >
            </p>
            <div *ngIf="element.isLoading" class="loading-data"></div>
          </td>
        </ng-container>

        <ng-container matColumnDef="membership_number">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Member ID</th>
          <td mat-cell *matCellDef="let element">
            <p *ngIf="!element.isLoading">
              {{ element.transactionid }}
            </p>
            <div *ngIf="element.isLoading" class="loading-data"></div>
          </td>
        </ng-container>
        <ng-container matColumnDef="member_name">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Member Name</th>
          <td mat-cell *matCellDef="let element">
            <p *ngIf="!element.isLoading">
              {{
                element.customers.firstname
                  ? element.customers.firstname +
                    "," +
                    element.customers.lastname
                  : "--"
              }}
            </p>
            <div *ngIf="element.isLoading" class="loading-data"></div>
          </td>
        </ng-container>

        <ng-container matColumnDef="tier">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Tier</th>
          <td mat-cell *matCellDef="let element">
            <div *ngIf="!element.isLoading">
              {{ element?.customers.mobile }}
            </div>
            <div *ngIf="element.isLoading" class="loading-data"></div>
          </td>
        </ng-container>

        <ng-container matColumnDef="membership_package_purchase">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            Membership Package Purchase
          </th>
          <td mat-cell *matCellDef="let element">
            <div *ngIf="!element.isLoading">
              {{
                element?.hotelmaster?.hotelName ||
                  element?.hotelmaster?.hotelname
              }}
            </div>
            <div *ngIf="element.isLoading" class="loading-data"></div>
          </td>
        </ng-container>
        <ng-container matColumnDef="membership_package_id">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            Membership Package ID
          </th>
          <td mat-cell *matCellDef="let element">
            <div *ngIf="!element.isLoading">
              {{ element?.rooms?.roomtitle }}
            </div>
            <div *ngIf="element.isLoading" class="loading-data"></div>
          </td>
        </ng-container>

        <ng-container matColumnDef="place">
          <th
            mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            class="check-in-column"
          >
            Place
          </th>
          <td mat-cell *matCellDef="let element" class="check-in-column">
            <div *ngIf="!element.isLoading">
              {{ element?.start_at | date : "Y-MM-dd" }}
            </div>
            <div *ngIf="element.isLoading" class="loading-data"></div>
          </td>
        </ng-container>
        <ng-container matColumnDef="date">
          <th
            mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            class="check-in-column"
          >
            Date
          </th>
          <td mat-cell *matCellDef="let element" class="check-in-column">
            <div *ngIf="!element.isLoading">
              {{ element?.end_at | date : "Y-MM-dd" }}
            </div>
            <div *ngIf="element.isLoading" class="loading-data"></div>
          </td>
        </ng-container>
        <ng-container matColumnDef="time">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Time</th>
          <td mat-cell *matCellDef="let element">
            <div *ngIf="!element.isLoading">
              {{ element?.created_at | date : "Y-MM-dd" }}
            </div>
            <div *ngIf="element.isLoading" class="loading-data"></div>
          </td>
        </ng-container>
        <ng-container matColumnDef="total_price">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Total Price</th>
          <td mat-cell *matCellDef="let element">
            <div *ngIf="!element.isLoading">
              {{ element?.created_at | date : "Y-MM-dd" }}
            </div>
            <div *ngIf="element.isLoading" class="loading-data"></div>
          </td>
        </ng-container>

        <ng-container matColumnDef="points_issued">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            Points Issued
          </th>
          <td mat-cell *matCellDef="let element">
            <div *ngIf="!element.isLoading">
              {{ element?.amount }}
            </div>
            <div *ngIf="element.isLoading" class="loading-data"></div>
          </td>
        </ng-container>

        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Status</th>
          <td mat-cell *matCellDef="let element">
            <p *ngIf="!element.isLoading">
              {{
                element &&
                element.specialrequest &&
                element.specialrequest !== "null"
                  ? element.specialrequest
                  : "-"
              }}
            </p>
            <div *ngIf="element.isLoading" class="loading-data"></div>
          </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr
          mat-row
          *matRowDef="let row; columns: displayedColumns"
          class="hdls-table-row"
        ></tr>
      </table>
      <table>
        <tr *ngIf="!dataSource.data.length">
          <td class="hdls-no-records-detail">No Records Found!</td>
        </tr>
      </table>
      <mat-paginator
        [pageSizeOptions]="[5, 10, 20]"
        showFirstLastButtons
        aria-label="Select page of periodic elements"
        (page)="changePage($event)"
      >
      </mat-paginator>
    </div>
  </div>
</section>
