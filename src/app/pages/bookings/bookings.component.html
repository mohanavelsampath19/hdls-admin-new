<section id="hdls-membership-container">
  <div class="search-section">
    <div class="add-product">
      <form (submit)="setSearchValue($event)" class="hdls-search-field">
        <input
          type="text"
          [(ngModel)]="userSearch"
          placeholder="Search"
          matInput
        (keyup)="applyFilter($event.target.value)" 
          placeholder="Search by users"
          #input
          name="userSearch"
        />
        <span>
          <a href="#" (click)="setSearchValue($event)">
            <img src="../../../assets/images/search.png" alt="Search" />
          </a>
        </span>
      </form>
    </div>
    <div class="hdls-filter">
      <form
        [formGroup]="hotelGroup"
        (ngSubmit)="getHotelBookings()"
        class="hdls-hotel-filter"
      >
        <mat-form-field class="hdls-form-field" appearance="fill">
          <mat-label>Hotel</mat-label>
          <mat-select class="hdls-form-select" formControlName="hotelid">
            <mat-option
              *ngFor="let hotels of hotelDetails"
              [key]="hotels.hotel_id"
              [value]="hotels.hotel_id"
              >{{ hotels.hotel_name }}</mat-option
            >
          </mat-select>
        </mat-form-field>
        <mat-form-field class="hdls-hotel-filter-date">
          <mat-label>Choose From Date</mat-label>
          <div class="hdls-date-picker">
            <input
              matInput
              [matDatepicker]="picker"
              formControlName="from_date"
            />
            <mat-datepicker-toggle
              matIconSuffix
              [for]="picker"
            ></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
          </div>
        </mat-form-field>
        <mat-form-field class="hdls-hotel-filter-date">
          <mat-label>Choose To Date</mat-label>
          <div class="hdls-date-picker">
            <input
              matInput
              [matDatepicker]="topicker"
              formControlName="to_date"
            />
            <mat-datepicker-toggle
              matIconSuffix
              [for]="topicker"
            ></mat-datepicker-toggle>
            <mat-datepicker #topicker></mat-datepicker>
          </div>
        </mat-form-field>
        <button
          type="button"
          (click)="getHotelBookings()"
          class="hdls-search-btn"
        >
          Search
        </button>
      </form>
    </div>
    <!-- <div class="download-section">
      <app-hdls-date-range
        (getDateRange)="getDateRange($event)"
      ></app-hdls-date-range>
      <div class="download-button">
        <a href="#"
          ><img src="../../../assets/images/download.png" alt="download"
        /></a>
      </div>
    </div> -->
  </div>
  <div id="hdls-membership-list">
    <!-- <div class="category-button">
      <a
        id="basic"
        class="add-button"
        [ngClass]="{ 'selected-item': selectedCategory === 'all' }"
        (click)="getSelectedFilter('all')"
      >
        All
      </a>
      <a
        id="basic"
        class="add-button"
        [ngClass]="{ 'selected-item': selectedCategory === 'live' }"
        (click)="getSelectedFilter('live')"
      >
      Accepted<span></span>
      </a>
      <a
        id="basic"
        class="add-button"
        [ngClass]="{ 'selected-item': selectedCategory === 'rejected' }"
        (click)="getSelectedFilter('rejected')"
      >
        Rejected<span></span>
      </a>
      <a
        id="basic"
        class="add-button"
        [ngClass]="{ 'selected-item': selectedCategory === 'cancelled' }"
        (click)="getSelectedFilter('cancelled')"
      >
        Completed<span></span>
      </a>
    </div> -->
    <div class="hdls-product-list-section hdls-booking-container">

      <!-- <app-search-field></app-search-field> -->
      <table
        mat-table
        class="hdls-product-table"
        [dataSource]="dataSource"
        matTableExporter
      >
        <ng-container matColumnDef="tribe_reference_id">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            Tribe Reference
          </th>
          <td mat-cell *matCellDef="let element">
            <p *ngIf="!element.isLoading">
              {{ element.bookingid }}
            </p>
            <div *ngIf="element.isLoading" class="loading-data"></div>
          </td>
        </ng-container>

        <ng-container matColumnDef="booking_id">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Booking ID</th>
          <td mat-cell *matCellDef="let element">
            <div *ngIf="!element.isLoading" class="hdls-hotel-name">
              <a href="#/report/booking-details/{{ element.bookingid }}">
                {{ element?.bookingid || "--" }}
              </a>
            </div>
            <div *ngIf="element.isLoading" class="loading-data"></div>
          </td>
        </ng-container>

        <ng-container matColumnDef="customer_id">
          <th
            mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            class="check-in-column"
          >
            Membership ID
          </th>
          <td mat-cell *matCellDef="let element" class="check-in-column">
            <div *ngIf="!element.isLoading" class="hdls-check-in">
              <a href="#/bookings?customerid={{ element.customerid }}">
                {{ element?.customerid || "--" }}
              </a>
            </div>
            <div *ngIf="element.isLoading" class="loading-data"></div>
          </td>
        </ng-container>
        <ng-container matColumnDef="customer_name">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Member Name</th>
          <td mat-cell *matCellDef="let element">
            <div *ngIf="!element.isLoading" class="hdls-customer-name">
              {{ element?.customer_name }}
            </div>
            <div *ngIf="element.isLoading" class="loading-data"></div>
          </td>
        </ng-container>
        <ng-container matColumnDef="mobile">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Mobile</th>
          <td mat-cell *matCellDef="let element">
            <div *ngIf="!element.isLoading" class="hdls-special-request">
              {{ element?.mobile || '-'}}
            </div>
            <div *ngIf="element.isLoading" class="loading-data"></div>
          </td>
        </ng-container>
        <ng-container matColumnDef="hotel">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Hotel</th>
          <td mat-cell *matCellDef="let element">
            <div *ngIf="!element.isLoading" class="hdls-amount">
              <a href="#" (click)="getBookingBasedOnHotelId($event, element.hotelmaster.hotel_id)">
                {{ element?.hotelname || "--" }}
              </a>
            </div>
            <div *ngIf="element.isLoading" class="loading-data"></div>
          </td>
        </ng-container>
        <ng-container matColumnDef="booking_date">
          <th
            mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            class="booking-date-column"
          >
            Booking Date
          </th>
          <td mat-cell *matCellDef="let element" class="booking-date-column">
            <p *ngIf="!element.isLoading" class="hdls-booking-date">
              {{ element.created_at }}
            </p>
            <div *ngIf="element.isLoading" class="loading-data"></div>
          </td>
        </ng-container>
        <ng-container matColumnDef="room">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Rooms</th>
          <td mat-cell *matCellDef="let element">
            <p *ngIf="!element.isLoading" class="hdls-remarks">
              {{ element?.roomtitle || "-" }}
            </p>
            <div *ngIf="element.isLoading" class="loading-data"></div>
          </td>
        </ng-container>
        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Status</th>
          <td mat-cell *matCellDef="let element">
            <div *ngIf="!element.isLoading" class="hdls-status">
              {{ element?.status }}
            </div>
            <div *ngIf="element.isLoading" class="loading-data"></div>
          </td>
        </ng-container>
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Actions</th>
          <td mat-cell *matCellDef="let element">
            <div *ngIf="!element.isLoading" class="hdls-action">
              <a
                href="#"
                (click)="
                  openBookingStatusChangePopup($event, element.bookingid, element.status, element)
                "
                *ngIf="element.status != 4"
                >Action</a
              >
              <div *ngIf="element.status == 4">
                <strong>{{ element.updated_at | date : "medium" }}</strong>
              </div>
            </div>
            <div *ngIf="element.isLoading" class="loading-data"></div>
          </td>
        </ng-container>
        <ng-container matColumnDef="check_in">
          <th
            mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            class="booking-date-column"
          >
            Checkin-Date
          </th>
          <td mat-cell *matCellDef="let element" class="booking-date-column">
            <p *ngIf="!element.isLoading" class="hdls-booking-date">
              {{ element?.created_at }}
            </p>
            <div *ngIf="element.isLoading" class="loading-data"></div>
          </td>
        </ng-container>
        <ng-container matColumnDef="check_out">
          <th
            mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            class="booking-date-column"
          >
            Check-out Date
          </th>
          <td mat-cell *matCellDef="let element" class="booking-date-column">
            <p *ngIf="!element.isLoading" class="hdls-booking-date">
              {{ element?.updated_at }}
            </p>
            <div *ngIf="element.isLoading" class="loading-data"></div>
          </td>
        </ng-container>
        <ng-container matColumnDef="time">
          <th
            mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            class="booking-date-column"
          >
            Time
          </th>
          <td mat-cell *matCellDef="let element" class="booking-date-column">
            <p *ngIf="!element.isLoading" class="hdls-booking-date">
              {{ element.time }}
            </p>
            <div *ngIf="element.isLoading" class="loading-data"></div>
          </td>
        </ng-container>
        <ng-container matColumnDef="total_amount">
          <th
            mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            class="booking-date-column"
          >
            Total Amount (Including VAT)
          </th>
          <td mat-cell *matCellDef="let element" class="booking-date-column">
            <p *ngIf="!element.isLoading" class="hdls-booking-date">
              {{
                element.tax | currency : "MYR " : "symbol" : "1.2-2"
              }}
            </p>
            <div *ngIf="element.isLoading" class="loading-data"></div>
          </td>
        </ng-container>
        <ng-container matColumnDef="special_requests">
          <th
            mat-header-cell
            *matHeaderCellDef
            mat-sort-header
            class="booking-date-column"
          >
            Special Requests
          </th>
          <td mat-cell *matCellDef="let element" class="booking-date-column">
            <p *ngIf="!element.isLoading" class="hdls-booking-date">
              {{ element.specialRequest || "--" }}
            </p>
            <div *ngIf="element.isLoading" class="loading-data"></div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr
          mat-row
          *matRowDef="let row; columns: displayedColumns"
          class="hdls-table-row"
        ></tr>
      </table>
      <table>
        <tr *ngIf="!dataSource.data.length">
          <td class="hdls-no-records-detail">No Records Found!</td>
        </tr>
      </table>
      <mat-paginator
        [pageSizeOptions]="[5, 10, 20]"
        showFirstLastButtons
        aria-label="Select page of periodic elements"
        (page)="changePage($event)"
      >
      </mat-paginator>
    </div>
  </div>
</section>
